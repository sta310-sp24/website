{
  "hash": "7935c500ffa4c2b296a44259b045f0ad",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 10: Correlated data\"\ndate: \"2024-02-19\"\nexecute: \n  warning: false\n  message: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(knitr)\nlibrary(patchwork)\n```\n:::\n\n\n# Scenario 1\n\n\n\n\n\n\n\n\n\n\n\n## Scenario 1a\n\nBelow is the code for the binomial logistic regression model and confidence intervals calculated using the profile likelihood approach (confidence intervals calculated based on likelihood function with no assumptions on the distribution of the parameter of interest, $\\beta_0$).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_1a <- glm(phat_1a ~ 1, family = binomial, weight = rep(10,24), \n                data = scenario_1)\n\ntidy(model_1a) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |    0.067|     0.129|     0.516|   0.606|\n\n\n:::\n:::\n\n\n95% CI of the **odds** of a pup with deformity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(confint(model_1a))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    2.5 %    97.5 % \n0.8298899 1.3778985 \n```\n\n\n:::\n:::\n\n\nThe 95% CI of the **probability** of a pup with deformity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(confint(model_1a)) / (1 + exp(confint(model_1a)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    2.5 %    97.5 % \n0.4535190 0.5794606 \n```\n\n\n:::\n:::\n\n\nNext we fit a quasibinomial model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquasi_model_1a <- glm(phat_1a ~ 1, family = quasibinomial,\n                      weight = rep(10,24), data = scenario_1)\n\ntidy(quasi_model_1a)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 5\n  term        estimate std.error statistic p.value\n  <chr>          <dbl>     <dbl>     <dbl>   <dbl>\n1 (Intercept)   0.0667     0.122     0.546   0.590\n```\n\n\n:::\n:::\n\n\n95% CI of the **odds** of a pup with deformity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(confint(quasi_model_1a))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    2.5 %    97.5 % \n0.8414573 1.3588535 \n```\n\n\n:::\n:::\n\n\nThe 95% CI of the **probability** of a pup with deformity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(confint(quasi_model_1a)) / (1 + exp(confint(quasi_model_1a)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    2.5 %    97.5 % \n0.4569518 0.5760652 \n```\n\n\n:::\n:::\n\n\n## Scenario 1b\n\n::: callout-note\n### Fit models for Scenario 1b\n\n\\\nFit the binomial and quasibinomial models for the data generated under Scenario 1b. Calculate the 95% CI for $p$ for each model.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Questions\n\n::: callout-note\n## Question 1\n\nHow do the quasibinomial analysis for Scenario 1b differ from the binomial analysis for Scenario 1b? Consider the coefficient estimates, standard error, predicted probabilities and associated 95% CI.\n:::\n\n::: callout-note\n## Question 2\n\nWhy are differences between the quasibinomial and binomial models of Scenario 1a less noticeable than the differences in Scenario 1b?\n:::\n\n# Scenario 2: Random effects model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscenario2_raw <- read_csv(\"data/scenario-2-raw-data.csv\") %>%\n  mutate(deformity = factor(deformity),\n         dam = factor(dam))\n```\n:::\n\n\nYou will need the **lme4** R package for random effects models and the **broom.mixed** package to tidy the output. Once the package is installed, remove `eval = F` from the code chunk options.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nlibrary(broom.mixed)\n\nrandom_effects_model <- glmer(deformity ~ dose + (1|dam), \n                          family = binomial, data = scenario2_raw)\ntidy(random_effects_model, conf.int = 3) |>\n  kable(digits = 3)\n```\n:::\n",
    "supporting": [
      "lec-10-correlated_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}