{
  "hash": "e9d3a76cc4966d87b11402cf2159b5d3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 13 AE: Multilevel models\"\nsubtitle: \"Interpretation + Estimation\"\ndate: \"02-28-2024\"\nexecute:\n  warning: false\n  message: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(lme4)\nlibrary(broom.mixed)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmusic <- read_csv(\"data/music-data.csv\") |>\n  mutate(orchestra = factor(if_else(instrument == \"orchestral instrument\", \n                                    1, 0)), \n         large_ensemble = factor(if_else(perform_type == \"Large Ensemble\", \n                                         1, 0)))\n```\n:::\n\n\n::: callout-important\nStart modeling building with exploratory data analysis of Level One and Level Two variables.\n:::\n\n## Model 1: Random intercepts model\n\nThis is also known as the unconditional means model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Model1 (Unconditional means model)\nmodel1 <- lmer(na ~ 1 + (1 | id),  data = music)\n\ntidy(model1) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|effect   |group    |term            | estimate| std.error| statistic|\n|:--------|:--------|:---------------|--------:|---------:|---------:|\n|fixed    |NA       |(Intercept)     |   16.237|     0.428|    37.943|\n|ran_pars |id       |sd__(Intercept) |    2.225|        NA|        NA|\n|ran_pars |Residual |sd__Observation |    4.739|        NA|        NA|\n\n\n:::\n:::\n\n\n## Model 2: Add Level One covariate\n\nAdd `large_ensemble` as a Level One covariate. This is called a *random slopes and intercepts* model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- lmer(na ~ large_ensemble + (large_ensemble | id),  \n               data = music)\n\ntidy(model2) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|effect   |group    |term                             | estimate| std.error| statistic|\n|:--------|:--------|:--------------------------------|--------:|---------:|---------:|\n|fixed    |NA       |(Intercept)                      |   16.730|     0.491|     34.09|\n|fixed    |NA       |large_ensemble1                  |   -1.676|     0.542|     -3.09|\n|ran_pars |id       |sd__(Intercept)                  |    2.517|        NA|        NA|\n|ran_pars |id       |cor__(Intercept).large_ensemble1 |   -0.759|        NA|        NA|\n|ran_pars |id       |sd__large_ensemble1              |    0.862|        NA|        NA|\n|ran_pars |Residual |sd__Observation                  |    4.666|        NA|        NA|\n\n\n:::\n:::\n\n\n## Model 3: Add Level Two covariates\n\nAdd orchestra as a Level Two covariate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel3 <- lmer(na ~ large_ensemble + orchestra + orchestra:large_ensemble + \n                 (large_ensemble | id), data = music)\n\ntidy(model3) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|effect   |group    |term                             | estimate| std.error| statistic|\n|:--------|:--------|:--------------------------------|--------:|---------:|---------:|\n|fixed    |NA       |(Intercept)                      |   15.930|     0.641|    24.833|\n|fixed    |NA       |large_ensemble1                  |   -0.911|     0.845|    -1.077|\n|fixed    |NA       |orchestra1                       |    1.693|     0.945|     1.791|\n|fixed    |NA       |large_ensemble1:orchestra1       |   -1.424|     1.099|    -1.295|\n|ran_pars |id       |sd__(Intercept)                  |    2.378|        NA|        NA|\n|ran_pars |id       |cor__(Intercept).large_ensemble1 |   -0.635|        NA|        NA|\n|ran_pars |id       |sd__large_ensemble1              |    0.672|        NA|        NA|\n|ran_pars |Residual |sd__Observation                  |    4.670|        NA|        NA|\n\n\n:::\n:::\n\n\n## Model 4: Add `mpqnem` as an additional Level Two covariate\n\n::: callout-note\n## Ex 1\n\nWrite the Level One and Level Two models.\n:::\n\n::: callout-note\n## Ex 2\n\nWrite the composite model.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel4 <- lmer(na ~ large_ensemble + orchestra + mpqnem +  \n                 orchestra:large_ensemble + mpqnem:large_ensemble +\n                 (large_ensemble | id), data = music)\n\ntidy(model4) |> \n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|effect   |group    |term                             | estimate| std.error| statistic|\n|:--------|:--------|:--------------------------------|--------:|---------:|---------:|\n|fixed    |NA       |(Intercept)                      |   11.568|     1.221|     9.478|\n|fixed    |NA       |large_ensemble1                  |   -0.280|     1.834|    -0.153|\n|fixed    |NA       |orchestra1                       |    1.001|     0.817|     1.225|\n|fixed    |NA       |mpqnem                           |    0.148|     0.038|     3.893|\n|fixed    |NA       |large_ensemble1:orchestra1       |   -0.949|     1.106|    -0.858|\n|fixed    |NA       |large_ensemble1:mpqnem           |   -0.030|     0.052|    -0.575|\n|ran_pars |id       |sd__(Intercept)                  |    1.813|        NA|        NA|\n|ran_pars |id       |cor__(Intercept).large_ensemble1 |   -0.379|        NA|        NA|\n|ran_pars |id       |sd__large_ensemble1              |    0.746|        NA|        NA|\n|ran_pars |Residual |sd__Observation                  |    4.670|        NA|        NA|\n\n\n:::\n:::\n\n\n::: callout-note\n## Ex 3\n\nInterpret the effect of `mpqnem` for solo and small ensembles.\n:::\n\n::: callout-note\n## Ex 4\n\nInterpret the effect of `mpqnem` for large ensembles.\n:::\n\n## Compare models\n\nYou can get model summary statistics using the `glance` function from the **broom.mixed** package.\n\n::: callout-note\n## Ex 5\n\nCalculate AIC and BIC for Models 1 - 4. Use these statistics to choose a final model.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}