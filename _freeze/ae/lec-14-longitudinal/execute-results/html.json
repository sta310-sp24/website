{
  "hash": "4c563eea5c7365ea9cb66b1f45778b39",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 14 AE: Modeling two-level longitudinal data\"\ndate: \"03-04-2024\"\nexecute:\n  warning: false\n  message: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(lme4)\nlibrary(broom.mixed)\nlibrary(skimr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncharter <- read_csv(\"data/charter-long.csv\") |>\n  mutate(urban = factor(urban),\n         charter = factor(charter))\n```\n:::\n\n\n## Exploratory data analysis\n\n::: callout-caution\nThis is not a complete EDA for this data.\n:::\n\n### Univariate EDA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = charter, aes(x = MathAvgScore))  + \n  geom_histogram(fill = \"steelblue\", color = \"black\") + \n  labs(title = \"Average math scores\", \n  subtitle = \"6th graders in Minneapolis public schools\")\n```\n\n::: {.cell-output-display}\n![](lec-14-longitudinal_files/figure-html/scores-histogram-1.png){width=672}\n:::\n:::\n\n\n### Bivariate EDA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = charter, aes(x = charter, y = MathAvgScore)) + \n  geom_boxplot(fill = \"steelblue\", color = \"black\")  +\n  labs(title = \"Average math scores of 6th graders in Minneapolis public schools\", \n       subtitle = \"by school type\")\n```\n\n::: {.cell-output-display}\n![](lec-14-longitudinal_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n## Ex 1\n\nMake a scatterplot of the average math score versus the proportion of students who receive free or reduced lunches in a school (based on 2010 figures).\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## scatterplot\n```\n:::\n\n\n::: callout-note\n## Ex 2\n\nWhat do you observe from each bivariate plot?\n:::\n\n### Lattice plot\n\nMake a lattice plot of the average math scores over time for 24 randomly selected schools.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(030424)\n\n# get sample of 24 schools\nsample_schools <- charter |>\n  distinct(schoolid) |>\n  sample_n(24) |> pull()\n\n# get data for those schools\nsample_data <- charter |>\n  filter(schoolid %in% sample_schools)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## lattice plot\n```\n:::\n\n\n### Spaghetti plots\n\nPlot average math scores over time for each school. Apply a LOESS smoother (locally estimated scatterplot smoother).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = charter, aes(x = year08, y = MathAvgScore)) + \n  geom_line(aes(group = schoolid), color = \"light gray\") + \n  geom_smooth(color = \"black\", linewidth = 1, method = \"loess\") + \n  labs(x =\"Years since 2008\",\n       y =\"Average Math Scores\", \n       title = \"Math Scores over time for 6th graders in Minneapolis public schools\")\n```\n\n::: {.cell-output-display}\n![](lec-14-longitudinal_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n## Ex 3\n\n-   What features are easier to observe in the lattice plots versus the spaghetti plot?\n\n-   What features are easier to observe in the spaghetti plot versus the lattice plot?\n:::\n\n::: callout-note\n## Ex 4\n\n-   Make a separate spaghetti plot of average maths scores over time by school type (charter vs. non-charter).\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# spaghetti plot by school type\n```\n:::\n\n\n::: callout-note\n## Ex 5\n\n-   How do the typical math scores from charter and non-charter schools compare over time?\n\n-   How does the variability in math scores from charter and non-charter schools compare over time?\n:::\n\n## Unconditional means model\n\n::: callout-note\n## Ex 6\n\nFit the unconditional means model and calculate the intraclass correlation.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the unconditional means model\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the intraclass correlation\n```\n:::\n\n\n## Unconditional growth model\n\n::: callout-note\n## Ex 7\n\nFit the unconditional growth model.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the unconditional growth model\n```\n:::\n\n\n::: callout-note\n## Ex 8\n\nCalculate the $Pseudo R^2$ to estimate the change of within school variance between the unconditional means and unconditional growth models.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pseudo R^2\n```\n:::\n\n\n## Model with school-level covariates\n\n::: callout-note\n## Ex 9\n\nFit the model with the school-level covariates.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit model with school level covariates\n```\n:::\n",
    "supporting": [
      "lec-14-longitudinal_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}