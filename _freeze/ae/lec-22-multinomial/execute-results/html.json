{
  "hash": "50494149a4774460958a63c40bd5448b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 22: Multilevel multinomial logistic model\"\ndate: \"2024-04-15\"\nexecute:\n  warning: false\n  message: false\nbibliography: references.bib\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n#label: load-packages-data\nlibrary(tidyverse)\nlibrary(knitr)\nlibrary(viridis)\nlibrary(broom.mixed)\nlibrary(mclogit)\n\ninhaler <- read_csv(\"data/inhaler.csv\")  |>\n  mutate(rating = factor(rating), \n         treat = factor(treat), \n         period = factor(period))\n```\n:::\n\n\n## Introduction\n\nToday's data come from an experiment in @ezzet1991. The authors analyze data from a two-treatment, two-period crossover trial to compare 2 inhalation devices for delivering the drug salbutamol in 286 asthma patients. Patients were asked to rate the clarity of leaflet instructions accompanying each device, using a 4-point ordinal scale.[^1]\n\n[^1]: Experiment description from <https://paul-buerkner.github.io/brms/reference/inhaler.html>\n\nWe will use the following variables:\n\n-   `subject`: The subject number\n-   `rating`: The rating of the inhaler instructions on a scale ranging from 1 to 4\n    -   1: easy to understand\n    -   2: only clear after rereading\n    -   3: not very clear\n    -   4: confusing\n-   `treat`: Indicator of which of the two inhaler devices was used\n-   `period`: Indicator of whether the rating is from the first or second inhaler evaluated\n\n**The goal of the analysis is to understand which inhaler was easier for participants to understand.**\n\n## Exploratory data analysis\n\n::: callout-note\n## Ex 1\n\nExamine the distribution of the response variable `rating`. In general, what did the participants think about the instructions?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## add code here\n```\n:::\n\n\n::: callout-note\n## Ex 2\n\nExamine the relationship between `rating` and `period`. Does there appear to be an association between the order and what participants thought about the instructions?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## add code here\n```\n:::\n\n\n::: callout-note\n## Ex 3\n\nExamine the relationship between `rating` and `treat`. Does there appear to be an association between the inhaler used and what participants thought about the instructions?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## add code here\n```\n:::\n\n\n## Model\n\n::: callout-note\n## Ex 4\n\nWe will fit a multinomial logistic model for multilevel data. We need a random effect for what term?\n:::\n\nForm of the multilevel multinomial logistic model:\n\nLet $\\pi_{ijk}$ be the probability of participant $i$ selecting rating $k$ in period $j$\n\n$$\\log\\Big(\\frac{\\pi_{ijk}}{\\pi_{ij1}}\\Big) = \\alpha_k + \\beta_{1k}treat_{ij} + \\beta_{2k}period_{ij} + u_{ik} \\hspace{8mm} u_{ik} \\sim N(0, \\sigma^2_k)$$\\\n\\\n\n::: callout-note\n## Ex 5\n\nFit the model using the `mblogit()` function from the **mclogit** R package[@mclogit].\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## add code to fit and display model\n```\n:::\n\n\n## Conclusions\n\n::: callout-note\n## Ex 6\n\nUse the model to describe the effect of the order (`period`).\n:::\n\n::: callout-note\n## Ex 7\n\nUse the model to describe the effect of the inhaler (`treat`)\n:::\n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}