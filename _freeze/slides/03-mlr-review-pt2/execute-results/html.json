{
  "hash": "fffa0f7f266a83d9739b781fca85853c",
  "result": {
    "markdown": "---\ntitle: \"Review of multiple linear regression\"\nsubtitle: \"Part 2\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"01.12.22\"\noutput:\n  xaringan::moon_reader:\n    mathjax: \"https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML\"\n    css: \"sta310-slides.css\"\n    logo: sta310-sticker.png\n    lib_dir: libs/font-awesome\n    nature:\n      highlightStyle: github\n      highlightLines: true\n      countIncrementalSlides: false\n      slideNumberFormat: \"%current%\" \n      ratio: \"16:9\"\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n:::\n:::\n\n\nclass: middle, center\n\n\\##[Click for PDF of slides](03-mlr-review-pt2.pdf)\n\n------------------------------------------------------------------------\n\n## Announcements\n\n-   Lab starts Thu 3:30 - 4:45pm online\n    -   Find Zoom link in Sakai\n-   Office hours this week:\n    -   Thu 2 - 3pm & Fri 1 - 2pm online (links in Sakai)\n    -   Full office hours schedule starts Tue, Jan 19\n-   Week 02 reading: [BMLR: Chapter 2- Beyond Least Squares: Using Likelihoods](https://bookdown.org/roback/bookdown-BeyondMLR/ch-beyondmost.html)\n\n------------------------------------------------------------------------\n\nclass: middle\n\n## Questions?\n\n------------------------------------------------------------------------\n\nclass: middle, inverse\n\n## Recap\n\n------------------------------------------------------------------------\n\n## Data: Kentucky Derby Winners\n\n.midi\\[ Today's data is from the Kentucky Derby, an annual 1.25-mile horse race held at the Churchill Downs race track in Louisville, KY. The data is in the file [derbyplus.csv](data/derbyplus.csv) and contains information for races 1896 - 2017. \\]\n\n.pull-left\\[\n\n.midi\\[**Response variable**\\]\n\n-   .midi\\[`speed`: Average speed of the winner in feet per second (ft/s)\\]\n\n.midi\\[**Additional variable**\\] .midi\\[- `winner`: Winning horse\\] \\]\n\n.pull-right\\[ .midi\\[**Predictor variables**\\] - .midi\\[`year`: Year of the race\\] - .midi\\[`condition`: Condition of the track (good, fast, slow)\\] - .midi\\[`starters`: Number of horses who raced\\]\\]\n\n------------------------------------------------------------------------\n\n## Data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nderby <- read_csv(\"data/derbyplus.csv\") %>%\n  mutate(yearnew = year - 1896)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nderby %>%\n  head(5) %>% kable()\n```\n\n::: {.cell-output-display}\n| year|winner        |condition | speed| starters| yearnew|\n|----:|:-------------|:---------|-----:|--------:|-------:|\n| 1896|Ben Brush     |good      | 51.66|        8|       0|\n| 1897|Typhoon II    |slow      | 49.81|        6|       1|\n| 1898|Plaudit       |good      | 51.16|        4|       2|\n| 1899|Manuel        |fast      | 50.00|        5|       3|\n| 1900|Lieut. Gibson |fast      | 52.28|        7|       4|\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Model 1: Main effects model (with centering)\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|term          | estimate| std.error| statistic| p.value|\n|:-------------|--------:|---------:|---------:|-------:|\n|(Intercept)   |   52.175|     0.194|   269.079|   0.000|\n|starters      |   -0.005|     0.017|    -0.299|   0.766|\n|yearnew       |    0.023|     0.002|     9.766|   0.000|\n|conditiongood |   -0.443|     0.231|    -1.921|   0.057|\n|conditionslow |   -1.543|     0.161|    -9.616|   0.000|\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Model 2: Include quadratic effect for year\n\n.midi\\[\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|term          | estimate| std.error| statistic| p.value|\n|:-------------|--------:|---------:|---------:|-------:|\n|(Intercept)   |  51.4130|    0.1826|  281.5645|  0.0000|\n|starters      |  -0.0253|    0.0136|   -1.8588|  0.0656|\n|yearnew       |   0.0700|    0.0061|   11.4239|  0.0000|\n|I(yearnew^2)  |  -0.0004|    0.0000|   -8.0411|  0.0000|\n|conditiongood |  -0.4770|    0.1857|   -2.5689|  0.0115|\n|conditionslow |  -1.3927|    0.1305|  -10.6701|  0.0000|\n:::\n:::\n\n\n\\]\n\n------------------------------------------------------------------------\n\n## Model 2: Check model assumptions\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-mlr-review-pt2_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nclass: middle, inverse\n\n## \\## Model 3\n\n## Include interaction term?\n\nRecall from the EDA...\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-mlr-review-pt2_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Model 3: Include interaction term\n\n$$\\begin{aligned}\\widehat{speed} = & 52.387 - 0.003 ~ starters + 0.020 ~ yearnew - 1.070 ~ good - 2.183 ~ slow \\\\ &+0.012 ~ yearnew \\times good + 0.012 ~ yearnew \\times slow \\end{aligned}$$\n\n.panelset.sideways\\[ .panel\\[.panel-name\\[Output\\]\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|term                  | estimate| std.error| statistic| p.value|\n|:---------------------|--------:|---------:|---------:|-------:|\n|(Intercept)           |   52.387|     0.200|   262.350|   0.000|\n|starters              |   -0.003|     0.016|    -0.189|   0.850|\n|yearnew               |    0.020|     0.003|     7.576|   0.000|\n|conditiongood         |   -1.070|     0.423|    -2.527|   0.013|\n|conditionslow         |   -2.183|     0.270|    -8.097|   0.000|\n|yearnew:conditiongood |    0.012|     0.008|     1.598|   0.113|\n|yearnew:conditionslow |    0.012|     0.004|     2.866|   0.005|\n:::\n:::\n\n\n\\]\n\n.panel\\[.panel-name\\[Code\\]\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmodel3 <- lm(speed ~ starters + yearnew + condition +\n               yearnew * condition, \n             data = derby)\ntidy(model3) %>% kable(digits = 4)\n```\n:::\n\n\n\\] .panel\\[.panel-name\\[Assumptions\\]\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-mlr-review-pt2_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\\] \\]\n\n------------------------------------------------------------------------\n\n## Interpreting interaction effects\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|term                  | estimate| std.error| statistic| p.value|\n|:---------------------|--------:|---------:|---------:|-------:|\n|(Intercept)           |   52.387|     0.200|   262.350|   0.000|\n|starters              |   -0.003|     0.016|    -0.189|   0.850|\n|yearnew               |    0.020|     0.003|     7.576|   0.000|\n|conditiongood         |   -1.070|     0.423|    -2.527|   0.013|\n|conditionslow         |   -2.183|     0.270|    -8.097|   0.000|\n|yearnew:conditiongood |    0.012|     0.008|     1.598|   0.113|\n|yearnew:conditionslow |    0.012|     0.004|     2.866|   0.005|\n:::\n:::\n\n\n[Click here](https://forms.gle/BrufiFdhQAi4WBWeA) for poll\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_7d86027d\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;margin:5%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">04</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Measures of model performance\n\n-   $\\color{#4187aa}{R^2}$: Proportion of variability in the response explained by the model.\n    -   Will always increase as predictors are added, so it shouldn't be used to compare models\n-   $\\color{#4187aa}{Adj. R^2}$: Similar to $R^2$ with a penalty for extra terms\n\n--\n\n-   $\\color{#4187aa}{AIC}$: Likelihood-based approach balancing model performance and complexity\n\n-   $\\color{#4187aa}{BIC}$: Similar to AIC with stronger penalty for extra terms\n\n--\n\n-   **Nested F Test (extra sum of squares F test)**: Generalization of t-test for individual coefficients to perform significance tests on nested models\n\n------------------------------------------------------------------------\n\n## Which model would you choose?\n\nUse the **`glance`** function to get model statistics.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|model  | r.squared| adj.r.squared|     AIC|     BIC|\n|:------|---------:|-------------:|-------:|-------:|\n|Model1 |     0.730|         0.721| 259.478| 276.302|\n|Model2 |     0.827|         0.819| 207.429| 227.057|\n|Model3 |     0.751|         0.738| 253.584| 276.016|\n:::\n:::\n\n\n## **Which model would you choose?**\n\n## Characteristics of a \"good\" final model\n\n-   Model can be used to answer primary research questions\n-   Predictor variables control for important covariates\n-   Potential interactions have been investigated\n-   Variables are centered, as needed, for more meaningful interpretations\n-   Unnecessary terms are removed\n-   Assumptions are met and influential points have been addressed\n-   Model tells a \"persuasive story parsimoniously\"\n\n<br>\n\n.footnote\\[List from Section 1.6.7 of [BMLR](https://bookdown.org/roback/bookdown-BeyondMLR/)\\]\n\n------------------------------------------------------------------------\n\nclass: middle, inverse\n\n## Inference for multiple linear regression\n\n------------------------------------------------------------------------\n\n## Inference for regression\n\nUse statistical inference to\n\n-   Determine if predictors are statistically significant (not necessarily practically significant!)\n-   Quantify uncertainty in coefficient estimates\n-   Quantify uncertainty in model predictions\n\n<br>\n\nIf L.I.N.E. assumptions are met, we can conduct inference using the $t$ distribution and estimated standard errors\n\n------------------------------------------------------------------------\n\n## Inference for regression\n\n.pull-left\\[\n\nWhen L.I.N.E. conditions are met\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-mlr-review-pt2_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\\]\n\n.pull-right\\[\n\n-   Use least squares regression to get the estimates $\\hat{\\beta}_0$, $\\hat{\\beta}_1$, and $\\hat{\\sigma}^2$\n\n-   $\\hat{\\sigma}$ is the **regression standard error**\n\n$$\\hat{\\sigma} = \\sqrt{\\frac{\\sum_{i=1}^n(y_i - \\hat{y}_i)^2}{n - p - 1}} = \\sqrt{\\frac{\\sum_{i=1}^n e_i^2}{n-p-1}}$$\n\nwhere $p$ is the number of non-intercept terms in the model\n\n(p = 1 in simple linear regression) \\]\n\n------------------------------------------------------------------------\n\n## Inference for $\\beta_j$\n\n-   Suppose we have the following model:\n\n$$y_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + \\dots + \\beta_p x_{pi} + \\epsilon_i \\hspace{5mm} \\epsilon \\sim N(0, \\sigma^2)$$\n\n--\n\n-   We use least squares regression to get estimates for the parameters $\\beta_0, \\beta_1, \\ldots, \\beta_p$ and $\\sigma^2$. The regression equation is\n\n$$\\hat{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_1 + \\hat{\\beta}_2 x_2 + \\dots + \\hat{\\beta}_p x_p$$\n\n-   When the L.I.N.E. assumptions are met, $\\hat{\\beta}_j \\sim N(\\beta_j, SE_{\\hat{\\beta}_j})$.\n    -   The objective of statistical inference is to understand $\\beta_j$\n    -   Use $\\hat{\\sigma}$ to estimate $SE_{\\hat{\\beta}_j}$, the **standard error of** $\\hat{\\beta}_j$\n\n------------------------------------------------------------------------\n\n## Inference for $\\beta_j$\n\n.eq\\[ $$SE_{\\hat{\\beta}_j} = \\hat{\\sigma}\\sqrt{\\frac{1}{(n-1)s_{x_j}^2}}$$\\]\n\nConduct inference for $\\beta_j$ using a $t$ distribution with $n-p-1$ degrees of freedom (df).\n\n-   $\\hat{\\beta}_j$ follows a $t$ distribution, because $\\hat{\\sigma}$ (not $\\sigma$) is used to calculate the standard error of $\\hat{\\beta}_j$.\n\n-   The distribution has $n-p-1$ df because we use up $p + 1$ df to calculate $\\hat{\\sigma}$, so there are $n - p - 1$ df left to understand variability.\n\n------------------------------------------------------------------------\n\n## Hypothesis test for $\\beta_j$\n\n.pull-left\\[ 1️⃣ State the hypotheses\n\n.eq\\[ $$\\small{H_0: \\beta_j = 0 \\text{ vs. }H_a: \\beta_j \\neq 0}$$\\]\n\n<br>\n\n2️⃣ Calculate the test statistic.\n\n.eq\\[ $$\\small{t = \\frac{\\hat{\\beta}_j - 0}{SE_{\\hat{\\beta}_j}} = \\frac{\\hat{\\beta}_j - 0}{\\hat{\\sigma}\\sqrt{\\frac{1}{(n-1)s_{x_j}^2}}}}$$\\] \\]\n\n.pull-right\\[ 3️⃣ Calculate the p-value.\n\n.eq\\[ $$\\text{p-value} = 2P(T > |t|) \\hspace{4mm} T \\sim t_{n-p-1}$$\\]\n\n<br>\n\n4️⃣ State the conclusion in context of the data.\n\n.eq\\[ Reject $H_0$ if p-value is sufficiently small.\\]\n\n\\]\n\n------------------------------------------------------------------------\n\n## Confidence intervals\n\n.eq\\[ The $C$% confidence confidence interval for $\\beta_j$ is\n\n$$\\begin{align}&\\hat{\\beta}_j \\pm t^* \\times SE_{\\hat{\\beta}_j}\\\\[8pt]\n&\\hat{\\beta}_j \\pm t^* \\times \\hat{\\sigma}\\sqrt{\\frac{1}{(n-1)s_{x_{j}}^2}}\\end{align}$$ where the critical value $t^* \\sim t(n-p-1)$ \\]\n\n**General interpretation:** We are $C$% confident that for every one unit increase in $x_j$, the response is expected to change by LB to UB units, holding all else constant.\n\n------------------------------------------------------------------------\n\n## Inference Activity (\\~8 minutes)\n\n-   Use the Model 3 output on the next slide to conduct a hypothesis test and interpret the 95% confidence interval for your assigned variable.\n\n    -   You do not have to do the calculations by hand.\n\n-   Choose one person to write your group's response on your slide [slide](https://docs.google.com/presentation/d/14WD6HUhUL4Z_i9tcG94tgfa9VbpDbAYkzprhAPB7O0w/edit?usp=sharing).\n\n-   Choose on person to share your group's responses with the class.\n\n------------------------------------------------------------------------\n\n## Model 3 output\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|term                  | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:---------------------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept)           |   52.387|     0.200|   262.350|   0.000|   51.991|    52.782|\n|starters              |   -0.003|     0.016|    -0.189|   0.850|   -0.035|     0.029|\n|yearnew               |    0.020|     0.003|     7.576|   0.000|    0.014|     0.025|\n|conditiongood         |   -1.070|     0.423|    -2.527|   0.013|   -1.908|    -0.231|\n|conditionslow         |   -2.183|     0.270|    -8.097|   0.000|   -2.717|    -1.649|\n|yearnew:conditiongood |    0.012|     0.008|     1.598|   0.113|   -0.003|     0.027|\n|yearnew:conditionslow |    0.012|     0.004|     2.866|   0.005|    0.004|     0.020|\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Additional review topics\n\n-   [Uncertainty in predictions](https://sta210-fa21.netlify.app/slides/07-slr-prediction.html#1)\n\n-   [Variable transformations](https://sta210-fa21.netlify.app/slides/14-transformations.html#1)\n\n-   [Comparing models using Nested F tests](https://sta210-fa21.netlify.app/slides/15-model-comparison.html#1)\n\n------------------------------------------------------------------------\n\n## Acknowledgements\n\nThese slides are based on content in [BMLR: Chapter 1 - Review of Multiple Linear Regression](https://bookdown.org/roback/bookdown-BeyondMLR/ch-MLRreview.html)\n",
    "supporting": [
      "03-mlr-review-pt2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/panelset-0.2.6/panelset.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/panelset-0.2.6/panelset.js\"></script>\n<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}