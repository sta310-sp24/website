{
  "hash": "b6b743bf8172200a4b34e68afffa302a",
  "result": {
    "markdown": "---\ntitle: \"Unifying theory of GLMs\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"February 5, 2024\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[üîó STA 310 - Spring 2024](https://sta310-sp24.netlify.app)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    slide-number: true\n    multiplex: false\n    transition: fade\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\n  warning: false\n  message: false\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Announcements\n\n-   HW 02 due Wed, Feb 07 at 11:59pm\n\n-   Project 01\n\n    -   presentations in class Wed, Feb 14\n\n    -   write up due Thu, Feb 15 at noon\n\n## Topics\n\n-   Identify the components common to all generalized linear models\n\n-   Find the canonical link based on the distribution of the response variable\n\n-   Properties of GLMs\n\n::: aside\nNotes based on Chapter 5 @roback2021beyond unless noted otherwise.\n:::\n\n# Unifying theory of GLMs\n\n## Many models; one family\n\nWe have studied models for a variety of response variables\n\n-   Least squares (Normal)\n-   Logistic (Bernoulli, Binomial, Multinomial)\n-   Log-linear (Poisson, Negative Binomial)\n\nThese models are all examples of **generalized linear models**.\n\nGLMs have a similar structure for their likelihoods, MLEs, variances, so we can use a generalized approach to find the model estimates and associated uncertainty.\n\n## Components of a GLM\n\n@nelder1972generalized defines a broad class of models called **generalized linear models** that generalizes multiple linear regression. GLMs are characterized by three components:\n\n<br>\n\n. . .\n\n1Ô∏è‚É£ Response variable with parameter $\\theta$ whose probability function can be written in exponential family form (**random component**)\n\n<br>\n\n. . .\n\n2Ô∏è‚É£ A linear combination of predictors, $\\eta = \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p$ (**systematic component**)\n\n<br>\n\n. . .\n\n3Ô∏è‚É£ A **link** function $g(\\theta)$ that connects $\\theta$ to $\\eta$\n\n## One-parameter exponential family form\n\nSuppose a probability (mass or density) function has a parameter $\\theta$. It is said to have a **one-parameter exponential family form** if\n\n<br>\n\n‚úÖ The support (set of possible values) does not depend on $\\theta$, and\n\n‚úÖ The probability function can be written in the following form\n\n$$f(y;\\theta) = e^{[a(y)b(\\theta) + c(\\theta) + d(y)]}$$\n\n## Mean and variance\n\n**On-parameter exponential family form**\n\n$$f(y;\\theta) = e^{[a(y)b(\\theta) + c(\\theta) + d(y)]}$$\n\nUsing this form:\n\n. . .\n\n$$E(Y) = -\\frac{c'(\\theta)}{b'(\\theta)} \\hspace{20mm} Var(Y) = \\frac{b''(\\theta)c'(\\theta) - c''(\\theta)b'(\\theta)}{[b'(\\theta)]^3}$$\n\n## Poisson in one-parameter exponential family form {.midi}\n\n$$P(Y = y) = \\frac{e^{-\\lambda}\\lambda^y}{y!} \\hspace{10mm} y = 0, 1, 2, \\ldots, \\infty$$\n\n. . .\n\n$$\\begin{aligned}P(Y = y) &= e^{-\\lambda}e^{y\\log(\\lambda)}e^{-\\log(y!)}\\\\\n& = e^{y\\log(\\lambda) - \\lambda - \\log(y!)}\\end{aligned}$$\n\n. . .\n\nRecall the form: $f(y;\\theta) = e^{[a(y)b(\\theta) + c(\\theta) + d(y)]}$, where the parameter $\\theta = \\lambda$ for the Poisson distribution\n\n. . .\n\n-   $a(y) = y$\n-   $b(\\lambda) = \\log(\\lambda)$\n-   $c(\\lambda) = -\\lambda$\n-   $d(y) = -\\log(y!)$\n\n## Poisson in exponential family form\n\n‚úÖ The support for the Poisson distribution is $y = 0, 1, 2, \\ldots, \\infty$. This does not depend on the parameter $\\lambda$.\n\n. . .\n\n‚úÖ The probability mass function can be written in the form $f(y;\\theta) = e^{[a(y)b(\\theta) + c(\\theta) + d(y)]}$\n\n<br>\n\n. . .\n\n**The Poisson distribution can be written in one-parameter exponential family form.**\n\n## Canonical link\n\nSuppose there is a response variable $Y$ from a distribution with parameter $\\theta$ and a set of predictors that can be written as a linear combination $\\eta = \\beta_0 + \\sum_{j=1}^{p}\\beta_jx_j = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p$\n\n<br>\n\n-   A **link function**, $g()$, is a monotonic and differentiable function that connects $\\theta$ to $\\eta$\n\n-   When working with a member of the one-parameter exponential family, $b(\\theta)$ is called the **canonical link**\n\n    -   Most commonly used link function\n\n## Canonical link for Poisson\n\nRecall the exponential family form:\n\n$$P(Y = y) = e^{y\\log(\\lambda) - \\lambda - \\log(y!)}$$\n\n<br>\n\n. . .\n\nthen the canonical link is $b(\\lambda) = \\log(\\lambda)$\n\n## GLM framework: Poisson response variable {.midi}\n\n1Ô∏è‚É£ Response variable with parameter $\\theta$ whose probability function can be written in exponential family form\n\n$$P(Y = y) = e^{y\\log(\\lambda) - \\lambda - \\log(y!)}$$\n\n<br>\n\n2Ô∏è‚É£ A linear combination of predictors, $$\\eta = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p$$\n\n<br>\n\n3Ô∏è‚É£ A function $g(\\lambda)$ that connects $\\lambda$ and $\\eta$\n\n$$\\log(\\lambda) = \\eta =  \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\beta_p x_p$$\n\n## Activity: Generalized linear models\n\n::: question\nFor your group's distribution\n\n-   Write the pmf or pdf in one-parameter exponential form.\n\n-   Describe an example of a setting where this random variable may be used.\n\n-   Identify the canonical link function.\n:::\n\n## Activity: Generalized linear models {.midi}\n\n::: question\n**Distributions**\n\n1.  Exponential\n2.  Gamma (with fixed $r$)\n3.  Geometric\n4.  Binary\n\nSee [BMLR - Section 3.6](https://bookdown.org/roback/bookdown-BeyondMLR/ch-distthry.html#additional-resources) for details on the distributions.\n:::\n\nIf your group finishes early, try completing the exercise for another distribution.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_03b01436\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;margin:5%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">08</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n## Using the exponential family form\n\nThe one-parameter exponential family form is utilized for\n\n-   Calculating MLEs of coefficients (recall iteratively reweighted least squares)\n\n-   Inference for coefficients\n\n-   Likelihood ratio and drop-in-deviance tests\n\nThe specific calculations are beyond the scope of this course. See Section 4.6 of @dunn2018generalized for more detail (available at Duke library).\n\n# References\n",
    "supporting": [
      "07-glm-theory_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}