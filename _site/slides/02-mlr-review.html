<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Maria Tackett">

<title>STA 310 - Spring 2024 - Review of multiple linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Review of multiple linear regression</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/sta310-sp24" rel="" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <a href="https://sta310-sp24.slack.com" rel="" title="Slack" class="quarto-navigation-tool px-1" aria-label="Slack"><i class="bi bi-slack"></i></a>
    <a href="https://canvas.duke.edu/courses/25310" rel="" title="Canvas" class="quarto-navigation-tool px-1" aria-label="Canvas"><i class="bi bi-person-fill"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Course information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../support.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Support</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful links</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Homework</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 06</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/project-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/project-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/final-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tips + resources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#announcements" id="toc-announcements" class="nav-link active" data-scroll-target="#announcements">Announcements</a></li>
  <li><a href="#computing-set-up" id="toc-computing-set-up" class="nav-link" data-scroll-target="#computing-set-up">Computing set up</a></li>
  <li><a href="#topics" id="toc-topics" class="nav-link" data-scroll-target="#topics">Topics</a></li>
  <li><a href="#statistical-models" id="toc-statistical-models" class="nav-link" data-scroll-target="#statistical-models">Statistical models</a>
  <ul class="collapse">
  <li><a href="#models-and-statistical-models" id="toc-models-and-statistical-models" class="nav-link" data-scroll-target="#models-and-statistical-models">Models and statistical models</a></li>
  <li><a href="#statistical-models-1" id="toc-statistical-models-1" class="nav-link" data-scroll-target="#statistical-models-1">Statistical models</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a></li>
  </ul></li>
  <li><a href="#motivating-generalized-linear-models-glms-and-multilevel-models" id="toc-motivating-generalized-linear-models-glms-and-multilevel-models" class="nav-link" data-scroll-target="#motivating-generalized-linear-models-glms-and-multilevel-models">Motivating generalized linear models (GLMs) and multilevel models</a>
  <ul class="collapse">
  <li><a href="#assumptions-for-linear-regression" id="toc-assumptions-for-linear-regression" class="nav-link" data-scroll-target="#assumptions-for-linear-regression">Assumptions for linear regression</a></li>
  <li><a href="#assumptions-for-linear-regression-1" id="toc-assumptions-for-linear-regression-1" class="nav-link" data-scroll-target="#assumptions-for-linear-regression-1">Assumptions for linear regression</a></li>
  <li><a href="#violations-in-assumptions" id="toc-violations-in-assumptions" class="nav-link" data-scroll-target="#violations-in-assumptions">Violations in assumptions</a></li>
  <li><a href="#violations-in-assumptions-1" id="toc-violations-in-assumptions-1" class="nav-link" data-scroll-target="#violations-in-assumptions-1">Violations in assumptions</a></li>
  <li><a href="#beyond-linear-regression" id="toc-beyond-linear-regression" class="nav-link" data-scroll-target="#beyond-linear-regression">Beyond linear regression</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">Multiple linear regression</a>
  <ul class="collapse">
  <li><a href="#data-kentucky-derby-winners" id="toc-data-kentucky-derby-winners" class="nav-link" data-scroll-target="#data-kentucky-derby-winners">Data: Kentucky Derby Winners</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#data-science-workflow" id="toc-data-science-workflow" class="nav-link" data-scroll-target="#data-science-workflow">Data science workflow</a></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">Exploratory data analysis (EDA)</a></li>
  <li><a href="#univariate-eda" id="toc-univariate-eda" class="nav-link" data-scroll-target="#univariate-eda">Univariate EDA</a></li>
  <li><a href="#univariate-eda-code" id="toc-univariate-eda-code" class="nav-link" data-scroll-target="#univariate-eda-code">Univariate EDA code</a></li>
  <li><a href="#bivariate-eda" id="toc-bivariate-eda" class="nav-link" data-scroll-target="#bivariate-eda">Bivariate EDA</a></li>
  <li><a href="#bivariate-eda-code" id="toc-bivariate-eda-code" class="nav-link" data-scroll-target="#bivariate-eda-code">Bivariate EDA code</a></li>
  <li><a href="#scatterplot-matrix" id="toc-scatterplot-matrix" class="nav-link" data-scroll-target="#scatterplot-matrix">Scatterplot matrix</a></li>
  <li><a href="#scatterplot-matrix-code" id="toc-scatterplot-matrix-code" class="nav-link" data-scroll-target="#scatterplot-matrix-code">Scatterplot matrix code</a></li>
  <li><a href="#multivariate-eda" id="toc-multivariate-eda" class="nav-link" data-scroll-target="#multivariate-eda">Multivariate EDA</a></li>
  <li><a href="#multivariate-eda-code" id="toc-multivariate-eda-code" class="nav-link" data-scroll-target="#multivariate-eda-code">Multivariate EDA code</a></li>
  <li><a href="#candidate-models" id="toc-candidate-models" class="nav-link" data-scroll-target="#candidate-models">Candidate models</a></li>
  </ul></li>
  <li><a href="#application-exercise" id="toc-application-exercise" class="nav-link" data-scroll-target="#application-exercise">Application exercise</a></li>
  <li><a href="#inference-for-regression" id="toc-inference-for-regression" class="nav-link" data-scroll-target="#inference-for-regression">Inference for regression</a>
  <ul class="collapse">
  <li><a href="#inference-for-regression-1" id="toc-inference-for-regression-1" class="nav-link" data-scroll-target="#inference-for-regression-1">Inference for regression</a></li>
  <li><a href="#hypothesis-testing-for-beta_j" id="toc-hypothesis-testing-for-beta_j" class="nav-link" data-scroll-target="#hypothesis-testing-for-beta_j">Hypothesis testing for <span class="math inline">\(\beta_j\)</span></a></li>
  <li><a href="#confidence-interval-for-beta_j" id="toc-confidence-interval-for-beta_j" class="nav-link" data-scroll-target="#confidence-interval-for-beta_j">Confidence interval for <span class="math inline">\(\beta_j\)</span></a></li>
  </ul></li>
  <li><a href="#application-exercise-1" id="toc-application-exercise-1" class="nav-link" data-scroll-target="#application-exercise-1">Application exercise</a>
  <ul class="collapse">
  <li><a href="#measures-of-model-performance" id="toc-measures-of-model-performance" class="nav-link" data-scroll-target="#measures-of-model-performance">Measures of model performance</a></li>
  <li><a href="#model-summary-statistics" id="toc-model-summary-statistics" class="nav-link" data-scroll-target="#model-summary-statistics">Model summary statistics</a></li>
  <li><a href="#characteristics-of-a-good-final-model" id="toc-characteristics-of-a-good-final-model" class="nav-link" data-scroll-target="#characteristics-of-a-good-final-model">Characteristics of a “good” final model</a></li>
  <li><a href="#next-class" id="toc-next-class" class="nav-link" data-scroll-target="#next-class">Next class</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/sta310-sp24/website/edit/main/slides/02-mlr-review.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/sta310-sp24/website/issues/new" class="toc-action">Report an issue</a></p></div></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="02-mlr-review.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Review of multiple linear regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Prof.&nbsp;Maria Tackett </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Jan 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="announcements" class="level2">
<h2 class="anchored" data-anchor-id="announcements">Announcements</h2>
<ul>
<li><p>HW 01 due Wed, Jan 24 at 11:59pm</p>
<ul>
<li>Released Thursday morning</li>
</ul></li>
<li><p>Labs start Thursday</p></li>
<li><p>Check <a href="https://sta310-sp24.netlify.app/course-overview">website</a> for office hours schedule</p></li>
<li><p>Added a Slack channel <code>#internships-research-opportunities</code> (optional)</p></li>
</ul>
</section>
<section id="computing-set-up" class="level2">
<h2 class="anchored" data-anchor-id="computing-set-up">Computing set up</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">green =</span> <span class="st">"#B5BA72"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="topics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="topics">Topics</h2>
<ul>
<li><p>Define statistical models</p></li>
<li><p>Motivate generalized linear models and multilevel models</p></li>
<li><p>Review multiple linear regression</p></li>
</ul>

<div class="no-row-height column-margin column-container"><div class="">
<p>Notes based on Chapter 1 of <span class="citation" data-cites="roback2021beyond">Roback and Legler (<a href="#ref-roback2021beyond" role="doc-biblioref">2021</a>)</span> unless noted otherwise.</p>
</div></div></section>
<section id="statistical-models" class="level1 page-columns page-full">
<h1>Statistical models</h1>
<section id="models-and-statistical-models" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="models-and-statistical-models">Models and statistical models</h2>
<p>Suppose we have observations <span class="math inline">\(y_1, \ldots, y_n\)</span></p>
<div class="incremental">
<ul class="incremental">
<li><p><strong>Model</strong>: Mathematical description of the process we think generates the observations</p></li>
<li><p><strong>Statistical model</strong>: Model that includes an equation describing the impact of explanatory variables (<strong>deterministic part)</strong> and probability distributions for parts of the process that are assumed to be random variation (<strong>random part)</strong></p></li>
</ul>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Definitions adapted from <span class="citation" data-cites="stroup2012generalized">Stroup (<a href="#ref-stroup2012generalized" role="doc-biblioref">2012</a>)</span></p>
</div></div></section>
<section id="statistical-models-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="statistical-models-1">Statistical models</h2>
<p>A statistical model must include</p>
<ol type="1">
<li>The observations</li>
<li>The deterministic (systematic) part of the process</li>
<li>The random part of the process with a statement of the presumed probability distribution</li>
</ol>

<div class="no-row-height column-margin column-container"><div class="">
<p>Definitions adapted from <span class="citation" data-cites="stroup2012generalized">Stroup (<a href="#ref-stroup2012generalized" role="doc-biblioref">2012</a>)</span></p>
</div></div></section>
<section id="example" class="level2 midi page-columns page-full">
<h2 class="midi anchored" data-anchor-id="example">Example</h2>
<p>Suppose we have the model for comparing two means:</p>
<p><span class="math display">\[
y_{ij} = \mu_i + \epsilon_{ij}
\]</span></p>
<p>where</p>
<p>. . .</p>
<div class="incremental">
<ul class="incremental">
<li><span class="math inline">\(i = 1, 2\)</span>: group</li>
</ul>
<!-- -->
<ul class="incremental">
<li><span class="math inline">\(j = 1, \ldots, n\)</span>: observation number</li>
<li><span class="math inline">\(n_i\)</span>: number of observations in group <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\mu_i\)</span>: mean of group <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(y_{ij}\)</span>: <span class="math inline">\(j^{th}\)</span> observation in the <span class="math inline">\(i^{th}\)</span> group</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> : random error (variation) associated with <span class="math inline">\(ij^{th}\)</span> observation</li>
</ul>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Adapted from <span class="citation" data-cites="stroup2012generalized">Stroup (<a href="#ref-stroup2012generalized" role="doc-biblioref">2012</a>)</span></p>
</div></div></section>
<section id="example-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<p><span class="math display">\[
y_{ij} = \mu_i + \epsilon_{ij}
\]</span></p>
<div class="incremental">
<ul class="incremental">
<li><p><span class="math inline">\(y_{ij}\)</span>: the observations</p></li>
<li><p><span class="math inline">\(\mu_i\)</span>: deterministic part of the model, no random variability</p></li>
<li><p><span class="math inline">\(e_{ij}\)</span> : random part of the model, indicating observations vary about their mean</p></li>
<li><p>Typically assume <span class="math inline">\(\epsilon_{ij}\)</span> are independent and identically distributed (i.i.d.) <span class="math inline">\(N(0, \sigma^2)\)</span></p></li>
</ul>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Adapted from <span class="citation" data-cites="stroup2012generalized">Stroup (<a href="#ref-stroup2012generalized" role="doc-biblioref">2012</a>)</span></p>
</div></div></section>
<section id="practice" class="level2">
<h2 class="anchored" data-anchor-id="practice">Practice</h2>
<div class="question">
<p>Suppose <span class="math inline">\(y_{ij}\)</span>’s are observed outcome data and <span class="math inline">\(x_i\)</span>’s are values of the explanatory variable. Assume a linear regression model can used to describe the process of generating <span class="math inline">\(y_{ij}\)</span> based on the <span class="math inline">\(x_i\)</span>.</p>
<ol type="1">
<li>Write the specification of the statistical model.</li>
<li>Label the 3 components of the model equation (observation, deterministic part, random part)</li>
<li>What is <span class="math inline">\(E(y_{ij})\)</span>, the expected value of the observations?</li>
</ol>
</div>
</section>
</section>
<section id="motivating-generalized-linear-models-glms-and-multilevel-models" class="level1">
<h1>Motivating generalized linear models (GLMs) and multilevel models</h1>
<section id="assumptions-for-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-for-linear-regression">Assumptions for linear regression</h2>
<ul>
<li><p><u><strong>L</strong></u><strong>inearity</strong>: Linear relationship between mean response and predictor variable(s)</p></li>
<li><p><u><strong>I</strong></u><strong>ndependence</strong>: Residuals are independent. There is no connection between how far any two points lie above or below regression line.</p></li>
<li><p><u><strong>N</strong></u><strong>ormality</strong>: Response follows a normal distribution at each level of the predictor (or combination of predictors)</p></li>
<li><p><u><strong>E</strong></u><strong>qual variance</strong>: Variability (variance or standard deviation) of the response is equal for all levels of the predictor (or combination of predictors)</p></li>
</ul>
</section>
<section id="assumptions-for-linear-regression-1" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="assumptions-for-linear-regression-1">Assumptions for linear regression</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-mlr-review_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Modified from Figure 1.1. in BMLR</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p><strong>Linearity</strong>: Linear relationship between mean of the response <span class="math inline">\(Y\)</span> and the predictor <span class="math inline">\(X\)</span></p></li>
<li><p><strong>Independence</strong>: No connection between how far any two points lie from regression line</p></li>
<li><p><strong>Normality</strong>: Response <span class="math inline">\(Y\)</span> follows a normal distribution at each level of the predictor <span class="math inline">\(X\)</span> (red curves)</p></li>
<li><p><strong>Equal variance</strong>: Variance of the response <span class="math inline">\(Y\)</span> is equal for all levels of the predictor <span class="math inline">\(X\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="violations-in-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="violations-in-assumptions">Violations in assumptions</h2>
<p><em>Do wealthy households tend to have fewer children compared to households with lower income?</em> Annual income and family size are recorded for a random sample of households.</p>
<ul>
<li>The response variable is number of children in the household.</li>
<li>The predictor variable is annual income in US dollars.</li>
</ul>
<div class="question">
<p>Which assumption(s) are obviously violated, if any?</p>
</div>
</section>
<section id="violations-in-assumptions-1" class="level2">
<h2 class="anchored" data-anchor-id="violations-in-assumptions-1">Violations in assumptions</h2>
<p>Medical researchers investigated the outcome of a particular surgery for patients with comparable stages of disease but different ages. The 10 hospitals in the study had at least two surgeons performing the surgery of interest. Patients were randomly selected for each surgeon at each hospital. The surgery outcome was recorded on a scale of 1 - 10.</p>
<ul>
<li>The response variable is surgery outcome, 1 - 10.</li>
<li>The predictor variable is patient age in years.</li>
</ul>
<div class="question">
<p>Which assumption(s) are obviously violated, if any?</p>
</div>
</section>
<section id="beyond-linear-regression" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="beyond-linear-regression">Beyond linear regression</h2>
<div class="incremental">
<ul class="incremental">
<li><p>When drawing conclusions from linear regression models, we do so assuming LINE are all met</p></li>
<li><p><strong>Generalized linear models</strong> require different assumptions and can accommodate violations in LINE</p>
<ul class="incremental">
<li>Relationship between response and predictor(s) can be nonlinear</li>
<li>Response variable can be non-normal</li>
<li>Variance in response can differ at each level of predictor(s)</li>
<li><strong>The independence assumption still must hold!</strong></li>
</ul></li>
<li><p><strong>Multilevel models</strong> are used to model data that violate the independence assumption, i.e.&nbsp;correlated observations</p></li>
</ul>
</div>
</section>
</section>
<section id="multiple-linear-regression" class="level1">
<h1>Multiple linear regression</h1>
<section id="data-kentucky-derby-winners" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="data-kentucky-derby-winners">Data: Kentucky Derby Winners</h2>
<p>Today’s data is from the Kentucky Derby, an annual 1.25-mile horse race held at the Churchill Downs race track in Louisville, KY. The data is in the file <a href="data/derbyplus.csv">derbyplus.csv</a> and contains information for races 1896 - 2017.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Response variable</strong></p>
<ul>
<li><code>speed</code>: Average speed of the winner in feet per second (ft/s)</li>
</ul>
<p><strong>Additional variable</strong></p>
<ul>
<li><code>winner</code>: Winning horse</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Predictor variables</strong></p>
<ul>
<li><code>year</code>: Year of the race</li>
<li><code>condition</code>: Condition of the track (good, fast, slow)</li>
<li><code>starters</code>: Number of horses who raced</li>
</ul>
</div>
</div>
<p><strong>Goal: Understand variability in average winner speed based on characteristics of the race.</strong></p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>derby <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/derbyplus.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>derby <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">winner</th>
<th style="text-align: left;">condition</th>
<th style="text-align: right;">speed</th>
<th style="text-align: right;">starters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1896</td>
<td style="text-align: left;">Ben Brush</td>
<td style="text-align: left;">good</td>
<td style="text-align: right;">51.66</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1897</td>
<td style="text-align: left;">Typhoon II</td>
<td style="text-align: left;">slow</td>
<td style="text-align: right;">49.81</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1898</td>
<td style="text-align: left;">Plaudit</td>
<td style="text-align: left;">good</td>
<td style="text-align: right;">51.16</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">1899</td>
<td style="text-align: left;">Manuel</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1900</td>
<td style="text-align: left;">Lieut. Gibson</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">52.28</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="data-science-workflow" class="level2">
<h2 class="anchored" data-anchor-id="data-science-workflow">Data science workflow</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/02/data-science-cycle.png" class="img-fluid figure-img" alt="Data science workflow cycle from R for Data Science"></p>
<figcaption class="figure-caption">Image source: <span class="citation" data-cites="wickham2023r">Wickham, Çetinkaya-Rundel, and Grolemund (<a href="#ref-wickham2023r" role="doc-biblioref">2023</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="exploratory-data-analysis-eda" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-eda">Exploratory data analysis (EDA)</h2>
<ul>
<li><p>Once you’re ready for the statistical analysis, the first step should always be <strong>exploratory data analysis</strong>.</p></li>
<li><p>The EDA will help you</p>
<ul>
<li>begin to understand the variables and observations</li>
<li>identify outliers or potential data entry errors</li>
<li>begin to see relationships between variables</li>
<li>identify the appropriate model and identify a strategy</li>
</ul></li>
<li><p>The EDA is exploratory; formal modeling and statistical inference are used to draw conclusions.</p></li>
</ul>
</section>
<section id="univariate-eda" class="level2">
<h2 class="anchored" data-anchor-id="univariate-eda">Univariate EDA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-mlr-review_files/figure-html/univar-eda-plot-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="univariate-eda-code" class="level2">
<h2 class="anchored" data-anchor-id="univariate-eda-code">Univariate EDA code</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> speed)) <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> colors<span class="sc">$</span>green, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Winning speed (ft/s)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> starters)) <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> colors<span class="sc">$</span>green, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Starters"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> condition)) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_bar</span>(<span class="at">fill =</span> colors<span class="sc">$</span>green, <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">x =</span> ))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> (p2 <span class="sc">/</span> p3) <span class="sc">+</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Univariate data analysis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bivariate-eda" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-eda">Bivariate EDA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-mlr-review_files/figure-html/bivar-eda-plot-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-eda-code" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-eda-code">Bivariate EDA code</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> starters, <span class="at">y =</span> speed)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Starters"</span>, <span class="at">y =</span> <span class="st">"Speed (ft / s)"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> speed)) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Speed (ft / s)"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> speed)) <span class="sc">+</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> colors<span class="sc">$</span>green, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Conditions"</span>, <span class="at">y =</span> <span class="st">"Speed (ft / s)"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>(p4 <span class="sc">+</span> p5) <span class="sc">+</span> p6 <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Bivariate data analysis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatterplot-matrix" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-matrix">Scatterplot matrix</h2>
<p>A <strong>scatterplot matrix</strong> helps quickly visualize relationships between many variable pairs. They are particularly useful to identify potentially correlated predictors.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-mlr-review_files/figure-html/scatterplot-matrix-plot-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-matrix-code" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-matrix-code">Scatterplot matrix code</h2>
<p>Create using the <code>ggpairs()</code> function in the GGally package.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(<span class="at">data =</span> derby, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"condition"</span>, <span class="st">"year"</span>, <span class="st">"starters"</span>, <span class="st">"speed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multivariate-eda" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-eda">Multivariate EDA</h2>
<p>Plot the relationship between the response and a predictor based on levels of another predictor to assess potential interactions.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-mlr-review_files/figure-html/multivar-eda-plot-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multivariate-eda-code" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-eda-code">Multivariate EDA code</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> derby, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> speed, <span class="at">color =</span> condition, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape =</span> condition, <span class="at">linetype =</span> condition)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">linetype =</span> condition)) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Speed (ft/s)"</span>, <span class="at">color =</span> <span class="st">"Condition"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Speed vs. year"</span>, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"by track condition"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">lty =</span> <span class="cn">FALSE</span>, <span class="at">shape =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="candidate-models" class="level2">
<h2 class="anchored" data-anchor-id="candidate-models">Candidate models</h2>
<p>Model 1: Main effects model (<code>year</code>, <code>condition</code>, <code>starters</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(speed <span class="sc">~</span> starters <span class="sc">+</span> year <span class="sc">+</span> condition, <span class="at">data =</span> derby)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>. . .</p>
<p>Model 2: Main effects + <span class="math inline">\(year^2\)</span>, the quadratic effect of <code>year</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(speed <span class="sc">~</span> starters <span class="sc">+</span> year <span class="sc">+</span> <span class="fu">I</span>(year<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> condition,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> derby)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>. . .</p>
<p>Model 3: Main effects + interaction between <code>year</code> and <code>condition</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(speed <span class="sc">~</span> starters <span class="sc">+</span> year <span class="sc">+</span> condition <span class="sc">+</span> year <span class="sc">*</span> condition, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> derby)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="application-exercise" class="level1">
<h1>Application exercise</h1>
<div class="appex">
<p>📋 <a href="../ae/ae-02-mlr-review.html">sta310-sp24.netlify.app/ae/ae-02-mlr-review</a></p>
</div>
</section>
<section id="inference-for-regression" class="level1">
<h1>Inference for regression</h1>
<p>Use statistical inference to</p>
<ul>
<li><p>Evaluate if predictors are statistically significant (not necessarily practically significant!)</p></li>
<li><p>Quantify uncertainty in coefficient estimates</p></li>
<li><p>Quantify uncertainty in model predictions</p></li>
</ul>
<p>If LINE assumptions are met, we can use inferential methods based on mathematical models. If at least linearity and independence are met, we can use simulation-based inference methods.</p>
<section id="inference-for-regression-1" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="inference-for-regression-1">Inference for regression</h2>
<p>When LINE assumptions are met… . . .</p>
<div class="incremental">
<ul class="incremental">
<li><p>Use least squares regression to obtain the estimates for the model coefficients <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_j\)</span> and for <span class="math inline">\(\sigma^2\)</span></p></li>
<li><p><span class="math inline">\(\hat{\sigma}\)</span> is the <strong>regression standard error</strong></p>
<p><span class="math display">\[
\hat{\sigma} = \sqrt{\frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n - p - 1}} = \sqrt{\frac{\sum_{i=1}^n e_i^2}{n-p-1}}
\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the number of non-intercept terms in the model (e.g., <span class="math inline">\(p = 1\)</span> in simple linear regression)</p></li>
<li><p>Goal is to use estimated values to draw conclusions about <span class="math inline">\(\beta_j\)</span></p>
<ul class="incremental">
<li>Use <span class="math inline">\(\hat{\sigma}\)</span> to calculate <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> . <a href="https://github.com/STA210-Sp19/supplemental-notes/blob/master/regression-basics-matrix.pdf">Click here</a> for more detail.</li>
</ul></li>
</ul>
</div>
</section>
<section id="hypothesis-testing-for-beta_j" class="level2 small">
<h2 class="small anchored" data-anchor-id="hypothesis-testing-for-beta_j">Hypothesis testing for <span class="math inline">\(\beta_j\)</span></h2>
<ol type="1">
<li><strong>State the hypotheses</strong>. <span class="math inline">\(H_0: \beta_j = 0 \text{ vs. } H_a: \beta_j \neq 0\)</span>, given the other variables in the model.</li>
</ol>
<p>. . .</p>
<ol start="2" type="1">
<li><strong>Calculate the test statistic.</strong></li>
</ol>
<p><span class="math display">\[
t = \frac{\hat{\beta}_j - 0}{SE_{\hat{\beta}_j}}
\]</span></p>
<p>. . .</p>
<ol start="3" type="1">
<li><p><strong>Calculate the p-value.</strong> The p-value is calculated from a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n - p - 1\)</span> degrees of freedom.</p>
<p><span class="math display">\[
\text{p-value} = 2P(T &gt; |t|) \hspace{4mm} T \sim t_{n-p-1}
\]</span></p></li>
</ol>
<p>. . .</p>
<ol start="4" type="1">
<li><strong>State the conclusion in context of the data.</strong>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> if p-value is sufficiently small.</li>
</ul></li>
</ol>
</section>
<section id="confidence-interval-for-beta_j" class="level2">
<h2 class="anchored" data-anchor-id="confidence-interval-for-beta_j">Confidence interval for <span class="math inline">\(\beta_j\)</span></h2>
<p>The <span class="math inline">\(C\%\)</span> confidence confidence interval for <span class="math inline">\(\beta_j\)</span> is</p>
<p><span class="math display">\[\hat{\beta}_j \pm t^* \times SE_{\hat{\beta}_j}\]</span></p>
<p>where the critical value <span class="math inline">\(t^* \sim t_{n-p-1}\)</span></p>
<p><br></p>
<p>. . .</p>
<p><strong>General interpretation for the confidence interval [LB, UB]</strong>:</p>
<p>We are <span class="math inline">\(C\%\)</span> confident that for every one unit increase in <span class="math inline">\(x_j\)</span>, the response is expected to change by LB to UB units, holding all else constant.</p>
</section>
</section>
<section id="application-exercise-1" class="level1 page-columns page-full">
<h1>Application exercise</h1>
<div class="appex">
<p>📋 <a href="../ae/ae-02-mlr-review.html">sta310-sp24.netlify.app/ae/ae-02-mlr-review</a></p>
</div>
<section id="measures-of-model-performance" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-model-performance">Measures of model performance</h2>
<ul>
<li><p><span class="math inline">\(R^2\)</span>: Proportion of variability in the response explained by the model</p>
<ul>
<li>Will always increase as predictors are added, so it shouldn’t be used to compare models</li>
</ul></li>
<li><p><span class="math inline">\(Adj. R^2\)</span>: Similar to <span class="math inline">\(R^2\)</span> with a penalty for extra terms</p></li>
<li><p><span class="math inline">\(AIC\)</span>: Likelihood-based approach balancing model performance and complexity</p></li>
<li><p><span class="math inline">\(BIC\)</span>: Similar to AIC with stronger penalty for extra terms</p></li>
</ul>
</section>
<section id="model-summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="model-summary-statistics">Model summary statistics</h2>
<p>Use the <code>glance()</code> function to get model summary statistics</p>
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model1</td>
<td style="text-align: right;">0.730</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">259.478</td>
<td style="text-align: right;">276.302</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model2</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.819</td>
<td style="text-align: right;">207.429</td>
<td style="text-align: right;">227.057</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model3</td>
<td style="text-align: right;">0.751</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">253.584</td>
<td style="text-align: right;">276.016</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>. . .</p>
<div class="question">
<p>Which model do you choose based on these statistics?</p>
</div>
</section>
<section id="characteristics-of-a-good-final-model" class="level2 midi page-columns page-full">
<h2 class="midi anchored" data-anchor-id="characteristics-of-a-good-final-model">Characteristics of a “good” final model</h2>
<ul>
<li><p>Model can be used to answer primary research questions</p></li>
<li><p>Predictor variables control for important covariates</p></li>
<li><p>Potential interactions have been investigated</p></li>
<li><p>Variables are centered, as needed, for more meaningful interpretations</p></li>
<li><p>Unnecessary terms are removed</p></li>
<li><p>Assumptions are met and influential points have been addressed</p></li>
<li><p>Model tells a “persuasive story parsimoniously”</p></li>
</ul>

<div class="no-row-height column-margin column-container"><div class="">
<p>List from Section 1.6.7 of <span class="citation" data-cites="roback2021beyond">Roback and Legler (<a href="#ref-roback2021beyond" role="doc-biblioref">2021</a>)</span></p>
</div></div></section>
<section id="next-class" class="level2">
<h2 class="anchored" data-anchor-id="next-class">Next class</h2>
<ul>
<li><p>Using likelihoods</p></li>
<li><p>See <a href="../prepare/jan-22.html">Prepare for Jan 22</a> lecture</p></li>
</ul>
</section>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-roback2021beyond" class="csl-entry" role="listitem">
Roback, Paul, and Julie Legler. 2021. <em>Beyond Multiple Linear Regression: Applied Generalized Linear Models and Multilevel Models in r</em>. CRC Press.
</div>
<div id="ref-stroup2012generalized" class="csl-entry" role="listitem">
Stroup, Walter W. 2012. <em>Generalized Linear Mixed Models: Modern Concepts, Methods and Applications</em>. CRC press.
</div>
<div id="ref-wickham2023r" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, and Garrett Grolemund. 2023. <em>R for Data Science</em>. " O’Reilly Media, Inc.".
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2024, Maria Tackett</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This site is built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>