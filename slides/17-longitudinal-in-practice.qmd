---
title: "Longitudinal modeling in practice"
date: "March 20, 2024"
date-format: "MMM DD, YYYY"
author: "Prof. Maria Tackett"
footer: "[ðŸ”— STA 310 - Spring 2024](https://sta310-sp24.netlify.app)"
logo: "../images/logo.png"
format: 
  revealjs:
    theme: slides.scss
    slide-number: true
    multiplex: false
    transition: fade
    incremental: false 
    chalkboard: true
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
execute:
  freeze: auto
  echo: true
  warning: false
  message: false
knitr:
  opts_chunk: 
    R.options:      
    width: 200
bibliography: references.bib
---

```{r setup, include = F}
knitr::opts_chunk$set(fig.width = 8,
                      fig.asp = 0.618, 
                      fig.retina = 3, 
                      dpt = 300, 
                      out.width = "70%",
                      fig.align = "center")

ggplot2::theme_set(ggplot2::theme_bw(base_size = 16))

colors <- tibble::tibble(green = "#B5BA72")
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(tidymodels)
library(knitr)
library(patchwork)
library(viridis)
library(lme4)
library(broom.mixed)
```

## Announcements

-   HW 04 due TODAY at 11:59pm

-   Project 02

    -   Draft report due Friday at noon

-   Introduce final project

## Topics {.midi}

-   Read @kudrnavcova2023better as example of longitudinal modeling in practice

    -   Background and motivation
    -   Data collection and structure
    -   Exploratory data analysis
    -   Modeling
    -   Results in context and limitations

-   (Mostly) reproduce models from the paper

::: callout-note
[Click here](https://canvas.duke.edu/courses/25310/files/folder/journal-articles?preview=1070654) to access the article on Canvas.
:::

## Background and motivation

::: question
Read the abstract and answer the following questions:

1.  What is the primary motivation for the study? What gap in the existing research do the researchers hope to address?
2.  What outcomes are the researchers primarily interested in?
3.  What effects are the researchers primarily interested in?
4.  What is a key conclusion from their study ?
:::

```{r}
#| echo: false
library(countdown)
countdown(minutes = 6, margin = 1.25)
```

## Data collection

-   Data are from the Czech Household Panel Survey (CHPS)
-   Data collected annually from 2015 - 2020 between June - October
-   Two-stage stratified sampling used
-   All members of a household were invited to participate
    -   Approached the same households for each wave (year)
-   Respondents filled out a paper questionnaire
-   Large reduction in response between 2018 and 2019 due to new requirements

## Data structure

Multilevel structure with 3 levels

-   **Level Three:** Household

    -   **Level Two:** Individual

        -   **Level One:** Wave

## Response variables

Response variables are based on the "subjective component of integrative quality of life theory."

![Figure 1 in @kudrnavcova2023better](images/17/fig1.PNG){fig-align="center" width="100%"}

Authors state that these factors are important for describing overall quality of life.

## Outcomes of interest {.midi}

We will focus on three of the outcomes:

::: incremental
-   **Life satisfaction (`lfstat_OT`)**: "represents a stable assessment of general feelings about life and indicates a long-term attitude"

    -   Measured as response, ranging from 0 (extremely dissatisfied) to 10 (extremely satisfied), to the question *"All things considered, how satisfied are you with your life as a whole?"*

-   **Wellbeing (`wellbe_OT`)**: "captures a person's emotional state and touches on their mental state"

    -   Measured as average response, ranging from "at no time" to "all of the time", to three items about how often in the last two weeks respondents *"have been cheerful and in good spirits"*, *"have felt calm and relaxed",* and *"have been active and vigorous"*
:::

## Outcomes of interest {.midi}

-   **Happiness (`happy_OT`**): a person's current positive emotional condition

    -   Measured as response, ranging from 0 (extremely unhappy) to 10 (extremely happy), to the question *"Taking all things together, how happy would you say you are?"*

## Sleep variables

::: question
Describe how each sleep variable is measured (page 6):

-   **sleep duration (`SDweek_OT`)**

-   **quality of sleep (`slequal_OT`)**

-   **social jetlag (`jetlag_OT`)**
:::

```{r}
#| echo: false

library(countdown)
countdown(minutes = 4, margin = 1.25)
```

## Other covariates

-   **sex**
-   **highest level of education attained** (basic and secondary vocational, secondary with maturita, tertiary education)
-   **household income** (divided into 6 categories)
-   **age**
-   **employment status** (employed, self-employed, unemployed, student, retired, on maternity leave)
-   **number of children below age 5 in the household**
-   **wave** (2018, 2019, 2020)

# Application exercise

Complete the Exploratory Data Analysis section.

::: appex
ðŸ“‹ [sta310-sp24.netlify.app/ae/lec-17-sleep-study](https://sta310-sp24.netlify.app/ae/lec-17-sleep-study)
:::

```{r}
#| echo: false
library(countdown)
countdown(minutes = 8, margin = 1.25)
```

# Modeling

## Analysis strategy

::: question
Read the *Statistical analysis strategy* on page 7.

-   What type of random effects did the researchers include in their models?
-   Describe the data wrangling and preparation.
-   Describe the modeling building process.
:::

```{r}
#| echo: false

library(countdown)
countdown(minutes = 5, margin = 1.25)
```

# Application exercise

Complete the Modeling section.

::: appex
ðŸ“‹ [sta310-sp24.netlify.app/ae/lec-17-sleep-study](https://sta310-sp24.netlify.app/ae/lec-17-sleep-study)
:::

```{r}
#| echo: false

library(countdown)
countdown(minutes = 5, margin = 1.25)
```

## Results

::: question
See the list of hypotheses the researchers want to test on page 4 -5 .

<br>

What term(s) in the model can we use to test each hypothesis?
:::

<br>

. . .

::: question
What are your conclusions about the effects of sleep on quality of life indicators?
:::

. . .

```{r}
#| echo: false

library(countdown)
countdown(minutes = 4, margin = 1.25)
```

## Limitations

::: question
What are some potential limitations of this study?
:::

## References
